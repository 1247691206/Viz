!function(){var t={version:"1.0.0",template:{}};t.bP=function(){function t(i){g=i,i.each(function(){var i=d3.select(this),o=t.bars(),u=i.selectAll(".subBars").data(o.subBars).enter().append("g").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).attr("class","subBars").append("rect").attr("x",e).attr("y",n).attr("width",r).attr("height",a);"undefined"!=typeof h&&u.style("fill",function(t){return h(t)});var s=i.selectAll(".edges").data(o.edges).enter().append("path").attr("class","edges").attr("d",function(t){return t.path}).style("fill-opacity",t.edgeOpacity());"undefined"!=typeof h&&s.style("fill",function(t){return h(t)}),i.selectAll(".mainBars").data(o.mainBars).enter().append("g").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).attr("class","mainBars").append("rect").attr("x",e).attr("y",n).attr("width",r).attr("height",a).on("mouseover",t.mouseover).on("mouseout",t.mouseout)})}function e(t){return-t.width}function n(t){return-t.height}function r(t){return 2*t.width}function a(t){return 2*t.height}var i,o,u,s,f,d,l,c,p,y,h,g,m;return t.data=function(e){return arguments.length?(y=e,t):y},t.fill=function(e){return arguments.length?(h=e,t):h},t.keyPrimary=function(e){return arguments.length?(i=e,t):"undefined"!=typeof i?i:function(t){return t[0]}},t.keySecondary=function(e){return arguments.length?(o=e,t):"undefined"!=typeof o?o:function(t){return t[1]}},t.value=function(e){return arguments.length?(u=e,t):"undefined"!=typeof u?u:function(t){return t[2]}},t.width=function(e){return arguments.length?(s=e,t):"undefined"!=typeof s?s:400},t.height=function(e){return arguments.length?(f=e,t):"undefined"!=typeof f?f:600},t.barSize=function(e){return arguments.length?(l=e,t):"undefined"!=typeof l?l:35},t.min=function(e){return arguments.length?(c=e,t):"undefined"!=typeof c?c:0},t.orient=function(e){return arguments.length?(d=e,t):"undefined"!=typeof d?d:"vertical"},t.pad=function(e){return arguments.length?(p=e,t):"undefined"!=typeof p?p:0},t.duration=function(e){return arguments.length?(duration=e,t):"undefined"!=typeof duration?duration:500},t.edgeOpacity=function(e){return arguments.length?(m=e,t):"undefined"!=typeof m?m:.4},t.bars=function(e){function n(t,n){return"undefined"==typeof e||e.part===n||d[e.part](t)===e.key}function r(){var e=t.min()/2;s.primary.forEach(function(t){t.height<e&&(t.height=e)}),s.secondary.forEach(function(t){t.height<e&&(t.height=e)})}function a(e){function r(r){return n(r,e)?t.value()(r):0}var a=d3.nest().key("primary"==e?t.keyPrimary():t.keySecondary()).rollup(function(t){return d3.sum(t,r)}).entries(t.data()),i=u(a,t.pad(),t.min(),0,"vertical"==l?t.height():t.width()),o=t.barSize();a.forEach(function(n,r){s[e].push({x:"horizontal"==l?(i[r].s+i[r].e)/2:"primary"==e?o/2:t.width()-o/2,y:"vertical"==l?(i[r].s+i[r].e)/2:"primary"==e?o/2:t.height()-o/2,height:"vertical"==l?(i[r].e-i[r].s)/2:o/2,width:"horizontal"==l?(i[r].e-i[r].s)/2:o/2,part:e,key:n.key,value:n.value,percent:i[r].p})})}function i(e){function r(r){return n(r,e)?t.value()(r):0}var a=d3.map(s[e],function(t){return t.key}),i=d3.nest().key("primary"==e?t.keyPrimary():t.keySecondary()).key("secondary"==e?t.keyPrimary():t.keySecondary()).rollup(function(t){return d3.sum(t,r)}).entries(t.data());i.forEach(function(n){var r=a.get(n.key),i=u(n.values,0,0,"vertical"==l?r.y-r.height:r.x-r.width,"vertical"==l?r.y+r.height:r.x+r.width),o=t.barSize();n.values.forEach(function(a,u){f[e].push({x:"vertical"==l?"primary"==e?o/2:t.width()-o/2:(i[u].s+i[u].e)/2,y:"horizontal"==l?"primary"==e?o/2:t.height()-o/2:(i[u].s+i[u].e)/2,height:("vertical"==l?i[u].e-i[u].s:o)/2,width:("horizontal"==l?i[u].e-i[u].s:o)/2,part:e,primary:"primary"==e?n.key:a.key,secondary:"primary"==e?a.key:n.key,value:a.value,percent:i[u].p*r.percent,index:"primary"==e?n.key+"|"+a.key:a.key+"|"+n.key})})})}function o(){var t=d3.map(f.secondary,function(t){return t.index});return f.primary.map(function(e){var n=t.get(e.index);return{path:"vertical"===l?["M",e.x+e.width,",",e.y+e.height,"V",e.y-e.height,"L",n.x-n.width,",",n.y-n.height,"V",n.y+n.height,"Z"].join(""):["M",e.x-e.width,",",e.y+e.height,"H",e.x+e.width,"L",n.x+n.width,",",n.y-n.height,"H",n.x-n.width,"Z"].join(""),primary:e.primary,secondary:e.secondary,value:e.value,percent:e.percent}})}function u(t,e,n,r,a){var i=n/(a-r-2*t.length*e),o=0,u=0,s=d3.sum(t,function(t){return t.value});t.forEach(function(t){t.value<i*s&&(o+=1,u+=t.value)});var f=1e-5>s?0:(a-r-2*t.length*e-o*n)/(s-u),d=r,l=[];return t.forEach(function(t){var r=t.value*f;l.push({s:d+e+(n>r?.5*(n-r):0),e:d+e+(n>r?.5*(n+r):r),p:1e-5>s?0:t.value/s}),d+=2*e+(n>r?n:r)}),l}var s={primary:[],secondary:[]},f={primary:[],secondary:[]},d={primary:t.keyPrimary(),secondary:t.keySecondary()},l=t.orient();return a("primary"),a("secondary"),i("primary"),i("secondary"),r(),{mainBars:s.primary.concat(s.secondary),subBars:f.primary.concat(f.secondary),edges:o()}},t.mouseover=function(i){var o=t.bars(i);g.selectAll(".mainBars").filter(function(t){return t.part===i.part&&t.key===i.key}).select("rect").style("stroke-opacity",1),g.selectAll(".subBars").data(o.subBars).transition().duration(t.duration()).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).select("rect").attr("x",e).attr("y",n).attr("width",r).attr("height",a);var u=g.selectAll(".edges").data(o.edges);u.filter(function(t){return t[i.part]===i.key}).transition().duration(t.duration()).style("fill-opacity",.5).attr("d",function(t){return t.path}),u.filter(function(t){return t[i.part]!==i.key}).transition().duration(t.duration()).style("fill-opacity",0).attr("d",function(t){return t.path}),g.selectAll(".mainBars").data(o.mainBars).transition().duration(t.duration()).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).select("rect").attr("x",e).attr("y",n).attr("width",r).attr("height",a)},t.mouseout=function(i){var o=t.bars();g.selectAll(".mainBars").filter(function(t){return t.part===i.part&&t.key===i.key}).select("rect").style("stroke-opacity",0),g.selectAll(".subBars").data(o.subBars).transition().duration(t.duration()).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).select("rect").attr("x",e).attr("y",n).attr("width",r).attr("height",a),g.selectAll(".edges").data(o.edges).transition().duration(t.duration()).style("fill-opacity",t.edgeOpacity()).attr("d",function(t){return t.path}),g.selectAll(".mainBars").data(o.mainBars).transition().duration(t.duration()).attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).select("rect").attr("x",e).attr("y",n).attr("width",r).attr("height",a)},t},t.gg=function(){function e(t){p=t,t.each(function(){var t=d3.select(this),n=e.domain(),r=e.scale(),a=e.inTick(),i=e.outTick(),o=e.outerRadius(),u=d3.range(n[0],n[1]+1,2);t.append("circle").attr("r",o).style("fill","url(#vizgg3"+y+")").attr("class","vizggouter"),t.append("circle").attr("r",e.innerRadius()).style("fill","url(#vizgg2"+y+")").style("filter","url(#vizgg5"+y+")");var s=t.append("g").style("stroke",e.tickColor());s.selectAll("line").data(u).enter().append("line").style("stroke-width","2").attr("x1",function(t){return o*(.95-a)*Math.cos(r(t))}).attr("y1",function(t){return o*(.95-a)*Math.sin(r(t))}).attr("x2",function(t){return.95*o*Math.cos(r(t))}).attr("y2",function(t){return.95*o*Math.sin(r(t))}),s.selectAll("line").filter(function(t){return t%10===0}).style("stroke-width","3").attr("x1",function(t){return o*(.95-i)*Math.cos(r(t))}).attr("y1",function(t){return o*(.95-i)*Math.sin(r(t))}),t.selectAll("text").data(u.filter(function(t){return t%10===0})).enter().append("text").attr("class","vizggtext").attr("x",function(t){return o*(.95-i)*.9*Math.cos(r(t))}).attr("y",function(t){return o*(.95-i)*.9*Math.sin(r(t))}).attr("dy",3).text(function(t){return t});var f=e.outerRadius()/m.outerRadius,d=180*e.scale()(e.value())/Math.PI+90;t.append("g").attr("transform","translate(1,1)").selectAll(".needleshadow").data([0]).enter().append("g").attr("transform","rotate("+d+")").attr("class","needleshadow").append("path").attr("d",["m 0",-130*f,5*f,175*f,-10*f,"0,z"].join(",")).style("filter","url(#vizgg6"+y+")"),t.selectAll(".needle").data([0]).enter().append("g").attr("transform","rotate("+d+")").attr("class","needle").append("polygon").attr("points",[-.5*f,-130*f,.5*f,-130*f,5*f,45*f,-5*f,45*f].join(",")).style("fill","url(#vizgg4"+y+")")})}var n,r,a,i,o,u,s,f,d,l,c,p,y,h,g,m={innerRadius:20,outerRadius:150,angleOffset:.7,startAngle:-1.5*Math.PI,endAngle:.5*Math.PI,inTick:.12,outTick:.2,needleColor:"#de2c2c",innerFaceColor:"#999999",faceColor:"#666666",tickColor:"#ffffff",domain:[0,100],duration:500,ease:"cubicInOut"};return e.scale=function(){return d3.scale.linear().domain(e.domain()).range([m.startAngle+e.angleOffset(),m.endAngle-e.angleOffset()])},e.innerRadius=function(t){return arguments.length?(n=t,e):"undefined"!=typeof n?n:m.innerRadius},e.outerRadius=function(t){return arguments.length?(r=t,e):"undefined"!=typeof r?r:m.outerRadius},e.angleOffset=function(t){return arguments.length?(d=t,e):"undefined"!=typeof d?d:m.angleOffset},e.inTick=function(t){return arguments.length?(h=t,e):"undefined"!=typeof h?h:m.inTick},e.outTick=function(t){return arguments.length?(g=t,e):"undefined"!=typeof g?g:m.outTick},e.needleColor=function(t){return arguments.length?(a=t,e):"undefined"!=typeof a?a:m.needleColor},e.innerFaceColor=function(t){return arguments.length?(i=t,e):"undefined"!=typeof i?i:m.innerFaceColor},e.tickColor=function(t){return arguments.length?(u=t,e):"undefined"!=typeof u?u:m.tickColor},e.faceColor=function(t){return arguments.length?(o=t,e):"undefined"!=typeof o?o:m.faceColor},e.domain=function(t){return arguments.length?(s=t,e):"undefined"!=typeof s?s:m.domain},e.duration=function(t){return arguments.length?(l=t,e):"undefined"!=typeof l?l:m.duration},e.ease=function(t){return arguments.length?(c=t,e):"undefined"!=typeof c?c:m.ease},e.value=function(t){return arguments.length?(f=t,e):"undefined"!=typeof f?f:.5*(m.domain[0]+m.domain[1])},e.defs=function(n,r){var a=n.append("defs");y=r;var i=e.needleColor(),o=e.innerFaceColor(),u=e.faceColor(),s=t.defs(a).lG().id("vizgg1"+r).sel();t.defs(s).stop().offset("0").stopColor(i),t.defs(s).stop().offset("1").stopColor(d3.rgb(i).darker(1));var f=t.defs(a).rG().id("vizgg2"+r).fx("35%").fy("65%").r("65%").spreadMethod("pad").sel();t.defs(f).stop().offset("0").stopColor(o),t.defs(f).stop().offset("1").stopColor(d3.rgb(o).darker(2));var d=t.defs(a).rG().id("vizgg3"+r).fx("35%").fy("65%").r("65%").spreadMethod("pad").sel();t.defs(d).stop().offset("0").stopColor(u),t.defs(d).stop().offset("1").stopColor(d3.rgb(u).darker(2)),t.defs(a).lG().id("vizgg4"+r).gradientUnits("userSpaceOnUse").y1("80").x1("-10").y2("80").x2("10").xlink("#vizgg1"+r);var l=t.defs(a).filter().id("vizgg5"+r).sel();t.defs(l).feFlood().result("flood").floodColor("rgb(0,0,0)").floodOpacity("0.6"),t.defs(l).feComposite().result("composite1").operator("in").in2("SourceGraphic")["in"]("flood"),t.defs(l).feGaussianBlur().result("blur").stdDeviation("2")["in"]("composite1"),t.defs(l).feOffset().result("offset").dy("2").dx("2"),t.defs(l).feComposite().result("composite2").operator("over").in2("offset")["in"]("SourceGraphic");var c=t.defs(a).filter().x("-0.3").y("-0.3").height("1.8").width("1.8").id("vizgg6"+r).sel();t.defs(c).feGaussianBlur().stdDeviation("2")},e.setNeedle=function(t){function n(t,e){return d3.interpolateString("rotate("+t+")","rotate("+e+")")}var r=180*e.scale()(t)/Math.PI+90,a=180*e.scale()(e.value())/Math.PI+90,i=e.ease();p.selectAll(".needle").data([t]).transition().duration(e.duration()).attrTween("transform",function(t){return n(a,r)}).ease(i),p.selectAll(".needleshadow").data([t]).transition().duration(e.duration()).attrTween("transform",function(t){return n(a,r)}).ease(i).each("end",function(){angle=t}),e.value(t)},e},t.defs=function(t){var e={},n=t;return e.sel=function(){return n},e.lG=function(){return n=n.append("linearGradient"),e},e.rG=function(){return n=n.append("radialGradient"),e},e.stop=function(){return n=n.append("stop"),e},e.filter=function(){return n=n.append("filter"),e},e.feFlood=function(){return n=n.append("feFlood"),e},e.feComposite=function(){return n=n.append("feComposite"),e},e.feOffset=function(){return n=n.append("feOffset"),e},e.feGaussianBlur=function(){return n=n.append("feGaussianBlur"),e},e.result=function(t){return n=n.attr("result",t),e},e.floodColor=function(t){return n=n.attr("flood-color",t),e},e.floodOpacity=function(t){return n=n.attr("flood-opacity",t),e},e.stdDeviation=function(t){return n=n.attr("stdDeviation",t),e},e.operator=function(t){return n=n.attr("operator",t),e},e.height=function(t){return n=n.attr("height",t),e},e.width=function(t){return n=n.attr("width",t),e},e["in"]=function(t){return n=n.attr("in",t),e},e.in2=function(t){return n=n.attr("in2",t),e},e.id=function(t){return n=n.attr("id",t),e},e.fx=function(t){return n=n.attr("fx",t),e},e.fy=function(t){return n=n.attr("fy",t),e},e.dx=function(t){return n=n.attr("dx",t),e},e.dy=function(t){return n=n.attr("dy",t),e},e.x1=function(t){return n=n.attr("x1",t),e},e.y1=function(t){return n=n.attr("y1",t),e},e.x2=function(t){return n=n.attr("x2",t),e},e.y2=function(t){return n=n.attr("y2",t),e},e.x=function(t){return n=n.attr("x",t),e},e.y=function(t){return n=n.attr("y",t),e},e.r=function(t){return n=n.attr("r",t),e},e.spreadMethod=function(t){return n=n.attr("spreadMethod",t),e},e.gradientUnits=function(t){return n=n.attr("gradientUnits",t),e},e.xlink=function(t){return n=n.attr("xlink:href",t),e},e.offset=function(t){return n=n.attr("offset",t),e},e.stopColor=function(t){return n=n.attr("stop-color",t),e},e},this.viz=t}();